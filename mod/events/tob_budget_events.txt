namespace = tob_budget
# Add resources to each merc clan's budget yearly
event = {
	id = tob_budget.1
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		every_country = {
			limit = { is_country_type = outer_bulwarks }
			change_variable = { which = bulwarkbudget value = 200 }
		}
	}
}

# Gateway for budget spending (on_decade_pulse)
event = {
	id = tob_budget.2
	hide_window = yes
	is_triggered_only = yes
	trigger = { years_passed > 30 }
	immediate = {
		every_country = {
			limit = { is_country_type = outer_bulwarks }
			country_event = { id = tob_budget.3 days = 5 }
			country_event = { id = tob_budget.3000 days = 5 }
			country_event = { id = tob_budget.3001 days = 5 }
			country_event = { id = tob_budget.3002 days = 5 }
			country_event = { id = tob_budget.3003 days = 10 }
			country_event = { id = tob_budget.3004 days = 5 }
		}
		# TODO
		# every_country = {
		# 	limit = {
		# 		NOT = {
		# 			is_country_type = outer_bulwarks
		# 		}
		# 		any_owned_fleet = {
		# 			OR = {
		# 				has_fleet_flag = bulwark_numbers_mercfleet
		# 				has_fleet_flag = bulwark_techies_mercfleet
		# 				has_fleet_flag = bulwark_monsters_mercfleet
		# 			}
		# 		}
		# 	}
		# 	country_event = { id = tob_budget.4 days = 5 } # (Reinforce leased fleets)
		# }
		# Right here is where tamer reinforcement and buying tamed fleets goes.
	}
}

# Check if merc fleets are gone, and if so replace them at no cost.
# This = outer_bulwarks
country_event = {
	id = tob_budget.3
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		NOR = {
			any_owned_fleet = { has_fleet_flag = bulwark_mercenary_fleet }
			AND = {
				has_country_flag = bulwark_numbers
				has_global_flag = bulwark_numbers_mercs_gone
			}
			AND = {
				has_country_flag = bulwark_techies
				has_global_flag = bulwark_techies_mercs_gone
			}
			AND = {
				has_country_flag = bulwark_monsters
				has_global_flag = bulwark_monsters_mercs_gone
			}
		}
	}
	immediate = {
		random_planet_within_border = {
			limit = { is_star = no }
			save_event_target_as = bulwark_mercs_respawn_here
		}
		if = {
			limit = { has_country_flag = bulwark_numbers }
			if = { limit = { NOT = { any_owned_leader = { has_leader_flag = bulwark_numbers_commander } } }
				create_leader = {
					class = admiral
					species = owner_species
					name = random
					skill = 1
					event_leader = yes							# Prevents this leader from leading factions and winning elections.
					immortal = yes							# can't be killed (not even in battle, unless fleet is destroyed)
					traits = {
						0 = leader_trait_bulwark_numbers
						0 = leader_trait_bulwark_default
					}
					effect = {
						set_leader_flag = bulwark_numbers_commander
						# save_global_event_target_as = bulwark_supremacists_commander
						save_event_target_as = bulwark_commander
					}
				}
			} else = {
				random_owned_leader = {
					limit = { has_leader_flag = bulwark_numbers_commander }
					save_event_target_as = bulwark_commander
				}
			}
			# event_target:tob_supremacist_faction
		} else_if = {
			limit = { has_country_flag = bulwark_techies }
			if = { limit = { NOT = { any_owned_leader = { has_leader_flag = bulwark_techies_commander } } }
				create_leader = {
					class = admiral
					species = owner_species
					name = random
					skill = 1
					event_leader = yes							# Prevents this leader from leading factions and winning elections.
					immortal = yes							# can't be killed (not even in battle, unless fleet is destroyed)
					traits = {
						0 = leader_trait_bulwark_techies
						0 = leader_trait_bulwark_default
					}
					effect = {
						set_leader_flag = bulwark_techies_commander
						# save_global_event_target_as = bulwark_technologist_commander
						save_event_target_as = bulwark_commander
					}
				}
			} else = {
				random_owned_leader = {
					limit = { has_leader_flag = bulwark_techies_commander }
					save_event_target_as = bulwark_commander
				}
			}
			# event_target:tob_technologist_faction
		} else_if = {
			limit = { has_country_flag = bulwark_monsters }
			if = {
				limit = { NOT = { any_owned_leader = { has_leader_flag = bulwark_monsters_commander } } }
				create_leader = {
					class = admiral
					species = owner_species
					name = random
					skill = 1
					event_leader = yes							# Prevents this leader from leading factions and winning elections.
					immortal = yes							# can't be killed (not even in battle, unless fleet is destroyed)
					traits = {
						0 = leader_trait_bulwark_monsters
						0 = leader_trait_bulwark_default
					}
					effect = {
						set_leader_flag = bulwark_monsters_commander
						# save_global_event_target_as = bulwark_tamer_commander
						save_event_target_as = bulwark_commander
					}
				}
			} else = {
				random_owned_leader = {
					limit = { has_leader_flag = bulwark_monsters_commander }
					save_event_target_as = bulwark_commander
				}
			}
			# event_target:tob_tamer_faction
		}
		create_fleet = {
			settings = {
				spawn_debris = no
				can_change_composition = no
				uses_naval_capacity = no
				can_upgrade = no
				can_change_leader = no
			}
			effect = {
				set_owner = root
				set_fleet_flag = bulwark_mercenary_fleet
				prev = {
					if = { limit = { has_country_flag = bulwark_country_numbersone }
						switch = { trigger = has_country_flag
							bulwark_country_techone =	{ create_dyn_bulwark_fleet = { LOWCORVETTE		= 40 LOWDESTROYER		= 25 } }
							bulwark_country_techtwo =	{ create_dyn_bulwark_fleet = { MEDCORVETTE		= 40 MEDDESTROYER		= 25 } }
							bulwark_country_techthree =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE		= 40 HIGHDESTROYER		= 25 } }
							bulwark_country_techfour =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE	= 40 HIGHERDESTROYER	= 25 } }
							bulwark_country_techfive =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE	= 40 HIGHESTDESTROYER	= 25 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techone }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 60 LOWDESTROYER	= 40 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 80 LOWDESTROYER	= 55 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 100 LOWDESTROYER	= 70 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 120 LOWDESTROYER	= 85 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techtwo }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 60 MEDDESTROYER =	40 LOWCRUISER = 10 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 80 MEDDESTROYER =	55 LOWCRUISER = 20 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 100 MEDDESTROYER =	70 LOWCRUISER = 30 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 120 MEDDESTROYER =	85 LOWCRUISER = 40 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techthree }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 60 HIGHDESTROYER =	40 MEDCRUISER = 10 LOWBATTLESHIP = 5 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 80 HIGHDESTROYER =	55 MEDCRUISER = 20 LOWBATTLESHIP = 10 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 100 HIGHDESTROYER =	70 MEDCRUISER = 30 LOWBATTLESHIP = 15 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 120 HIGHDESTROYER =	85 MEDCRUISER = 40 LOWBATTLESHIP = 20 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techfour }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 60 HIGHERDESTROYER =	40 HIGHCRUISER = 10 MEDBATTLESHIP = 5 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 80 HIGHERDESTROYER =	55 HIGHCRUISER = 20 MEDBATTLESHIP = 10 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 100 HIGHERDESTROYER =	70 HIGHCRUISER = 30 MEDBATTLESHIP = 15 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 120 HIGHERDESTROYER =	85 HIGHCRUISER = 40 MEDBATTLESHIP = 20 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techfive }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 60 HIGHESTDESTROYER =	40 HIGHESTCRUISER = 10 HIGHESTBATTLESHIP = 5 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 80 HIGHESTDESTROYER =	55 HIGHESTCRUISER = 20 HIGHESTBATTLESHIP = 10 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 100 HIGHESTDESTROYER =	70 HIGHESTCRUISER = 30 HIGHESTBATTLESHIP = 15 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 120 HIGHESTDESTROYER =	85 HIGHESTCRUISER = 40 HIGHESTBATTLESHIP = 20 } }
						}
					}
				}
				assign_leader = event_target:bulwark_commander
				set_location = event_target:bulwark_mercs_respawn_here
				set_formation_scale = 2
				set_fleet_stance = aggressive
				set_fleet_bombardment_stance = indiscriminate
				set_aggro_range_measure_from = self
				set_aggro_range = 250
			}
		}
		last_created_fleet = {
			prev = {
				switch = { trigger = has_country_flag
					bulwark_country_techone =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techone } } }
					bulwark_country_techtwo =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techtwo } } }
					bulwark_country_techthree =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techthree } } }
					bulwark_country_techfour =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techfour } } }
					bulwark_country_techfive =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techfive } } }
				}
				# add_modifier = { modifier = "bulwark_ships_unlimited" }
				switch = { trigger = has_country_flag
					bulwark_numbers = { prev = { set_fleet_flag = bulwark_numbers_mercfleet } }
					bulwark_techies = { prev = { set_fleet_flag = bulwark_techies_mercfleet } }
					bulwark_monsters = { prev = { set_fleet_flag = bulwark_monsters_mercfleet } }
				}
			}
		}
	}
}

country_event = {
	id = tob_budget.5
	title = "tob_budget.5.name"
	desc = "tob_budget.5.desc"
	picture = GFX_evt_pirate_armada
	show_sound = event_radio_chatter
	is_triggered_only = yes
	option = { name = tob_budget.5.a }
}

# Checks if Vanguard Fleets are gone, and if so replace them if it's affordable
# This = outer_bulwarks
country_event = {
	id = tob_budget.3000
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		NAND = {
			any_owned_fleet = { has_fleet_flag = bulwark_vanguard_one }
			any_owned_fleet = { has_fleet_flag = bulwark_vanguard_two }
		}
		check_variable = { which = bulwarkbudget value >= 700 }
	}
	immediate = {
		subtract_variable = { which = bulwarkbudget value = 700 }
		random_planet_within_border = {
			limit = { is_star = no }
			save_event_target_as = bulwark_vanguard_respawns_here
		}
		create_leader = {
			class = admiral
			species = owner_species
			name = random
			skill = 1
			event_leader = yes				# Prevents this leader from leading factions and winning elections.
			immortal = yes				# can't be killed (not even in battle, unless fleet is destroyed)
		}
		create_fleet = {
			settings = {
				spawn_debris = no
				can_change_composition = no
				uses_naval_capacity = no
				can_upgrade = no
				can_change_leader = no
			}
			effect = {
				set_owner = root
				prev = {
					if = { limit = { has_country_flag = bulwark_country_numbersone }
						switch = { trigger = has_country_flag
							bulwark_country_techone =	{ create_dyn_bulwark_fleet = { LOWCORVETTE		= 40 LOWDESTROYER		= 25 } }
							bulwark_country_techtwo =	{ create_dyn_bulwark_fleet = { MEDCORVETTE		= 40 MEDDESTROYER		= 25 } }
							bulwark_country_techthree =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE		= 40 HIGHDESTROYER		= 25 } }
							bulwark_country_techfour =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE	= 40 HIGHERDESTROYER	= 25 } }
							bulwark_country_techfive =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE	= 40 HIGHESTDESTROYER	= 25 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techone }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 60 LOWDESTROYER	= 40 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 80 LOWDESTROYER	= 55 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 100 LOWDESTROYER	= 70 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { LOWCORVETTE = 120 LOWDESTROYER	= 85 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techtwo }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 60 MEDDESTROYER =	40 LOWCRUISER = 10 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 80 MEDDESTROYER =	55 LOWCRUISER = 20 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 100 MEDDESTROYER =	70 LOWCRUISER = 30 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { MEDCORVETTE = 120 MEDDESTROYER =	85 LOWCRUISER = 40 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techthree }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 60 HIGHDESTROYER =	40 MEDCRUISER = 10 LOWBATTLESHIP = 5 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 80 HIGHDESTROYER =	55 MEDCRUISER = 20 LOWBATTLESHIP = 10 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 100 HIGHDESTROYER =	70 MEDCRUISER = 30 LOWBATTLESHIP = 15 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { HIGHCORVETTE = 120 HIGHDESTROYER =	85 MEDCRUISER = 40 LOWBATTLESHIP = 20 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techfour }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 60 HIGHERDESTROYER =	40 HIGHCRUISER = 10 MEDBATTLESHIP = 5 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 80 HIGHERDESTROYER =	55 HIGHCRUISER = 20 MEDBATTLESHIP = 10 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 100 HIGHERDESTROYER =	70 HIGHCRUISER = 30 MEDBATTLESHIP = 15 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { HIGHERCORVETTE = 120 HIGHERDESTROYER =	85 HIGHCRUISER = 40 MEDBATTLESHIP = 20 } }
						}
					} else_if = { limit = { has_country_flag = bulwark_country_techfive }
						switch = { trigger = has_country_flag
							bulwark_country_numberstwo =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 60 HIGHESTDESTROYER =	40 HIGHESTCRUISER = 10 HIGHESTBATTLESHIP = 5 } }
							bulwark_country_numbersthree =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 80 HIGHESTDESTROYER =	55 HIGHESTCRUISER = 20 HIGHESTBATTLESHIP = 10 } }
							bulwark_country_numbersfour =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 100 HIGHESTDESTROYER =	70 HIGHESTCRUISER = 30 HIGHESTBATTLESHIP = 15 } }
							bulwark_country_numbersfive =	{ create_dyn_bulwark_fleet = { HIGHESTCORVETTE = 120 HIGHESTDESTROYER =	85 HIGHESTCRUISER = 40 HIGHESTBATTLESHIP = 20 } }
						}
					}
				}
				assign_leader = last_created_leader
				set_location = event_target:bulwark_vanguard_respawns_here
				set_formation_scale = 2
				set_fleet_stance = aggressive
				set_fleet_bombardment_stance = indiscriminate
				set_aggro_range_measure_from = self
				set_aggro_range = 250
			}
		}
		# TODO test if it is needed separated
		# Set ship flags for reinforcement
		last_created_fleet = {
			prev = {
				switch = { trigger = has_country_flag
					bulwark_country_techone =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techone } } }
					bulwark_country_techtwo =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techtwo } } }
					bulwark_country_techthree =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techthree } } }
					bulwark_country_techfour =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techfour } } }
					bulwark_country_techfive =	{ prev = { every_owned_ship = { set_ship_flag = bulwark_ship_techfive } } }
				}
				if = { limit = { NOT = { any_owned_fleet = { has_fleet_flag = bulwark_vanguard_two } } }
					prev = { set_fleet_flag = bulwark_vanguard_two }
				} else = { prev = { set_fleet_flag = bulwark_vanguard_one } }
			}
		}
	}
}

# Bulwark Habitats rebuild themselves for the cost of one year's production.
# This = outer_bulwarks
country_event = {
	id = tob_budget.3001
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		count_owned_ship = {
			limit = { is_ship_size = bulwark_station }
			count < 7
		}
	}
	immediate = {
		if = {
			limit = {
				check_variable = { which = bulwarkbudget value >= 200 }
			}
			while = {
				limit = {
					check_variable = { which = bulwarkbudget value >= 200 }
					count_owned_ship = {
						limit = { is_ship_size = bulwark_station }
						count < 7
					}
				}
				count < 7
				subtract_variable = { which = bulwarkbudget value = 200 }
				random_system_within_border = {
					limit = {
						any_system_planet = {
							is_star = no
							NOT = { any_fleet_in_orbit = { any_owned_ship = { is_ship_size = bulwark_station } } }
						}
					}
					random_system_planet = {
						limit = {
							is_star = no
							NOT = {
								any_fleet_in_orbit = {
									any_owned_ship = { is_ship_size = bulwark_station }
								}
							}
						}
						# save_event_target_as = bulwark_station_respawn_here
						create_fleet = {
							effect = {
								set_owner = root
								create_ship = {
									name = random
									design = "NAME_BULWARK_HABITAT"
									effect = {
										# add_modifier = { modifier = "bulwark_budget_repairs" days = 5 }
										add_modifier = { modifier = "bulwark_core_station" }
									}
								}
								set_location = prev # event_target:bulwark_station_respawn_here
							}
							settings = { spawn_debris = no }
						}
					}
				}
			}
		}
	}
}

# Buying repairs if possible, doesn't affect ships in combat if possible.
# This = outer_bulwarks
country_event = {
	id = tob_budget.3002
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		check_variable = { which = bulwarkbudget value >= 500 }
		any_owned_ship = {
			is_damaged = yes
			is_in_combat = no
			NOT = { has_modifier = bulwark_budget_repairs }
		}
	}
	immediate = {
		subtract_variable = { which = bulwarkbudget value = 500 }
		every_owned_ship = {
			limit = {
				is_damaged = yes
				is_in_combat = no
				NOT = { has_modifier = bulwark_budget_repairs }
			}
			add_modifier = { modifier = bulwark_budget_repairs days = 10 }
		}
	}
}

# After all the above has taken into consideration, attempt to perform quest.
# This = outer_bulwarks
country_event = {
	id = tob_budget.3003
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		years_passed >= 20
		check_variable = { which = bulwarkbudget value >= 500 }
		NOR = {
			# has_country_flag = bulwark_cannot_quest
			has_country_flag = bulwark_questing
			has_country_flag = bulwark_recently_quested
			has_country_flag = bulwark_finished_all_quests
		}
	}
	immediate = {
		if = {
			limit = {
				check_variable = { which = bulwarkbudget value >= 1000 }
			}
			subtract_variable = { which = bulwarkbudget value = 1000 }
			change_variable = { which = bulwarkquestbudget value = 1000 }
			country_event = { id = tob_quest.1 days = 2 }
		} else_if = {
			limit = {
				check_variable = { which = bulwarkbudget value >= 500 }
			}
			subtract_variable = { which = bulwarkbudget value = 500 }
			change_variable = { which = bulwarkquestbudget value = 500 }
			country_event = { id = tob_quest.1 days = 2 }
		}
	}
}

# Here's where the reinforcements come in.
# This = outer_bulwarks
country_event = {
	id = tob_budget.3004
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		check_variable = { which = bulwarkbudget value > 19 }
		any_owned_fleet = {
			OR = {
				has_fleet_flag = bulwark_mercenary_fleet
				has_fleet_flag = bulwark_vanguard_one
				has_fleet_flag = bulwark_vanguard_two
			}
			bulwark_fleet_needs_reinforcements = yes
		}
	}
	immediate = {
		random_owned_fleet = {
			limit = {
				OR = {
					has_fleet_flag = bulwark_mercenary_fleet
					has_fleet_flag = bulwark_vanguard_one
					has_fleet_flag = bulwark_vanguard_two
				}
				bulwark_fleet_needs_reinforcements = yes
			}
			if = { limit = { root = { has_country_flag = bulwark_country_numbersone } }
				if = {
					limit = {
						root = { has_country_flag = bulwark_country_techone }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techone
							}
							count < 40
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_LOWCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techone }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techtwo }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techtwo
							}
							count < 40
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_MEDCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techtwo }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techthree }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techthree
							}
							count < 40
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techthree }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfour }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfour
							}
							count < 40
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHERCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfour }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfive }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfive
							}
							count < 40
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHESTCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfive }
					}
				}
			} else_if = {
				limit = { root = { has_country_flag = bulwark_country_numberstwo } }
				if = {
					limit = {
						root = { has_country_flag = bulwark_country_techone }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techone
							}
							count < 60
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_LOWCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techone }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techtwo }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techtwo
							}
							count < 60
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_MEDCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techtwo }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techthree }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techthree
							}
							count < 60
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techthree }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfour }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfour
							}
							count < 60
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHERCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfour }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfive }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfive
							}
							count < 60
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHESTCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfive }
					}
				}
			} else_if = {
				limit = { root = { has_country_flag = bulwark_country_numbersthree } }
				if = {
					limit = {
						root = { has_country_flag = bulwark_country_techone }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techone
							}
							count < 80
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_LOWCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techone }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techtwo }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techtwo
							}
							count < 80
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_MEDCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techtwo }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techthree }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techthree
							}
							count < 80
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techthree }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfour }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfour
							}
							count < 80
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHERCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfour }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfive }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfive
							}
							count < 80
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHESTCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfive }
					}
				}
			} else_if = {
				limit = { root = { has_country_flag = bulwark_country_numbersfour } }
				if = {
					limit = {
						root = { has_country_flag = bulwark_country_techone }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techone
							}
							count < 100
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_LOWCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techone }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techtwo }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techtwo
							}
							count < 100
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_MEDCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techtwo }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techthree }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techthree
							}
							count < 100
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techthree }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfour }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfour
							}
							count < 100
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHERCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfour }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfive }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfive
							}
							count < 100
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHESTCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfive }
					}
				}
			} else_if = {
				limit = { root = { has_country_flag = bulwark_country_numbersfive } }
				if = {
					limit = {
						root = { has_country_flag = bulwark_country_techone }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techone
							}
							count < 120
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_LOWCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techone }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techtwo }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techtwo
							}
							count < 120
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_MEDCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techtwo }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techthree }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techthree
							}
							count < 120
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techthree }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfour }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfour
							}
							count < 120
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHERCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfour }
					}
				} else_if = {
					limit = {
						root = { has_country_flag = bulwark_country_techfive }
						count_owned_ship = {
							limit = {
								is_ship_size = corvette
								has_ship_flag = bulwark_ship_techfive
							}
							count < 120
						}
					}
					subtract_variable = { which = bulwarkbudget value = 5 }
					create_ship = {
						name = random
						design = "NAME_BULWARK_HIGHESTCORVETTE"
						graphical_culture = "pirate_01"
						effect = { set_ship_flag = bulwark_ship_techfive }
					}
				}
				# last_created_ship = {
				# 	# add_modifier = { modifier = "bulwark_ships_unlimited" }
				# 	# add_modifier = { modifier = "bulwark_budget_repairs" days = 5 }
				# }
			}
		}
		if = { limit = { check_variable = { which = bulwarkbudget value > 19 } }
			random_owned_fleet = {
				limit = {
					OR = {
						has_fleet_flag = bulwark_mercenary_fleet
						has_fleet_flag = bulwark_vanguard_one
						has_fleet_flag = bulwark_vanguard_two
					}
					bulwark_fleet_needs_reinforcements = yes
				}
				if = { limit = { root = { has_country_flag = bulwark_country_numbersone } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techone }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techone
								}
								count < 25
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techone }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 25
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techthree
								}
								count < 25
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfour
								}
								count < 25
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHERDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfive
								}
								count < 25
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersone } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techone }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techone
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techone }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techthree
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfour
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHERDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfive
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersthree } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techone }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techone
								}
								count < 55
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techone }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 55
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techthree
								}
								count < 55
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfour
								}
								count < 55
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHERDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfive
								}
								count < 55
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersfour } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techone }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techone
								}
								count < 70
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techone }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 70
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techthree
								}
								count < 70
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfour
								}
								count < 70
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHERDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfive
								}
								count < 70
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersfive } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techone }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techone
								}
								count < 85
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techone }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 85
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techthree
								}
								count < 85
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfour
								}
								count < 85
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHERDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = destroyer
									has_ship_flag = bulwark_ship_techfive
								}
								count < 85
							}
						}
						subtract_variable = { which = bulwarkbudget value = 10 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTDESTROYER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				}
				# last_created_ship = {
				# 	# add_modifier = { modifier = "bulwark_ships_unlimited" }
				# 	# add_modifier = { modifier = "bulwark_budget_repairs" days = 5 }
				# }
			}
		}
		if = { limit = { check_variable = { which = bulwarkbudget value > 19 } }
			random_owned_fleet = {
				limit = {
					OR = {
						has_fleet_flag = bulwark_mercenary_fleet
						has_fleet_flag = bulwark_vanguard_one
						has_fleet_flag = bulwark_vanguard_two
					}
					bulwark_fleet_needs_reinforcements = yes
				}
				if = { limit = { root = { has_country_flag = bulwark_country_numberstwo } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 10
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techthree
								}
								count < 10
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfour
								}
								count < 10
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfive
								}
								count < 10
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersthree } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 20
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techthree
								}
								count < 20
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfour
								}
								count < 20
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfive
								}
								count < 20
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersfour } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 30
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techthree
								}
								count < 30
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfour
								}
								count < 30
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfive
								}
								count < 30
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersfive } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techtwo }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techtwo
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techtwo }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techthree
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfour
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = cruiser
									has_ship_flag = bulwark_ship_techfive
								}
								count < 40
							}
						}
						subtract_variable = { which = bulwarkbudget value = 15 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTCRUISER"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				}
				# last_created_ship = {
				# 	# add_modifier = { modifier = "bulwark_ships_unlimited" }
				# 	# add_modifier = { modifier = "bulwark_budget_repairs" days = 5 }
				# }
			}
		}
		if = { limit = { check_variable = { which = bulwarkbudget value > 19 } }
			random_owned_fleet = {
				limit = {
					OR = {
						has_fleet_flag = bulwark_mercenary_fleet
						has_fleet_flag = bulwark_vanguard_one
						has_fleet_flag = bulwark_vanguard_two
					}
					bulwark_fleet_needs_reinforcements = yes
				}
				if = {
					limit = { root = { has_country_flag = bulwark_country_numberstwo } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techthree
								}
								count < 5
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfour
								}
								count < 5
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfive
								}
								count < 5
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersthree } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techthree
								}
								count < 10
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfour
								}
								count < 10
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfive
								}
								count < 10
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersfour } }
					if = {
							limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techthree
								}
								count < 15
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfour
								}
								count < 15
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfive
								}
								count < 15
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				} else_if = {
					limit = { root = { has_country_flag = bulwark_country_numbersfive } }
					if = {
						limit = {
							root = { has_country_flag = bulwark_country_techthree }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techthree
								}
								count < 20
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_LOWBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techthree }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfour }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfour
								}
								count < 20
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_MEDBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfour }
						}
					} else_if = {
						limit = {
							root = { has_country_flag = bulwark_country_techfive }
							count_owned_ship = {
								limit = {
									is_ship_size = battleship
									has_ship_flag = bulwark_ship_techfive
								}
								count < 20
							}
						}
						subtract_variable = { which = bulwarkbudget value = 20 }
						create_ship = {
							name = random
							design = "NAME_BULWARK_HIGHESTBATTLESHIP"
							graphical_culture = "pirate_01"
							effect = { set_ship_flag = bulwark_ship_techfive }
						}
					}
				}
				# last_created_ship = { exists = last_created_ship Invalid context switch
					# add_modifier = { modifier = "bulwark_ships_unlimited" }
					# add_modifier = { modifier = "bulwark_budget_repairs" days = 5 }
				# }
			}
		}
		country_event = { id = tob_budget.3004 days = 5 }
	}
}
